<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Teacher Value-Added — vam • vamR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Teacher Value-Added — vam"><meta name="description" content="This program uses student-level outcomes (typically test scores) to compute teacher value-added (VA) measures.
The estimation procedure accounts for drift in teacher VA over time.
This package is based on Michael Stepner's Stata program and intended to produce identical results with the speed gains made possible by R."><meta property="og:description" content="This program uses student-level outcomes (typically test scores) to compute teacher value-added (VA) measures.
The estimation procedure accounts for drift in teacher VA over time.
This package is based on Michael Stepner's Stata program and intended to produce identical results with the speed gains made possible by R."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vamR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9010</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/brbackes/vamR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Teacher Value-Added</h1>
      <small class="dont-index">Source: <a href="https://github.com/brbackes/vamR/blob/HEAD/R/vam_ado.R" class="external-link"><code>R/vam_ado.R</code></a></small>
      <div class="d-none name"><code>vam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This program uses student-level outcomes (typically test scores) to compute teacher value-added (VA) measures.
The estimation procedure accounts for drift in teacher VA over time.
This package is based on Michael Stepner's Stata program and intended to produce identical results with the speed gains made possible by R.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vam</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  teacher <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  class <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  controls <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tfx_resid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  absorb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  driftlimit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quasi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tv_name <span class="op">=</span> <span class="st">"tv"</span>,</span>
<span>  scores_name <span class="op">=</span> <span class="st">"score_r"</span>,</span>
<span>  cfr_test <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cfr_school <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cfr_grade <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cfr_subject <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cfr_weight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_df_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_cfr_test_only <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Required. The outcome variable in quotations.</p></dd>


<dt id="arg-teacher">teacher<a class="anchor" aria-label="anchor" href="#arg-teacher"></a></dt>
<dd><p>Required. The name of the teacher identifier in quotations.</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>Required. The name of the year identifier in quotations.</p></dd>


<dt id="arg-class">class<a class="anchor" aria-label="anchor" href="#arg-class"></a></dt>
<dd><p>Required. The name of the classroom identifier in quotations.</p></dd>


<dt id="arg-controls">controls<a class="anchor" aria-label="anchor" href="#arg-controls"></a></dt>
<dd><p>Controls to be used in the residualization.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Perform VA estimation separately for each by-group. Ex by = c("subject", "level").</p></dd>


<dt id="arg-tfx-resid">tfx_resid<a class="anchor" aria-label="anchor" href="#arg-tfx-resid"></a></dt>
<dd><p>Absorb fixed effects during y residualization, but include those fixed effects in the residual.</p></dd>


<dt id="arg-absorb">absorb<a class="anchor" aria-label="anchor" href="#arg-absorb"></a></dt>
<dd><p>Residualize y on absorbed fixed effects.</p></dd>


<dt id="arg-driftlimit">driftlimit<a class="anchor" aria-label="anchor" href="#arg-driftlimit"></a></dt>
<dd><p>Estimate only # autocovariances; set all further autocovariances equal to the last estimate.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Required. Data frame to use.</p></dd>


<dt id="arg-quasi">quasi<a class="anchor" aria-label="anchor" href="#arg-quasi"></a></dt>
<dd><p>Default FALSE. Generates two additional leave-out VA measures, which are typically used for quasi-experimental tests. This option adds <code>tv_2yr_l</code>,
which leaves out the forecast year and the prior year, and <code>tv_2yr_f</code>, which leaves out the forecast year and the following year. Note that if
<code>tv_name</code> is specified, those names will also apply to the <code>_2yr_f</code> and <code>_2yr_l</code> variables.</p></dd>


<dt id="arg-tv-name">tv_name<a class="anchor" aria-label="anchor" href="#arg-tv-name"></a></dt>
<dd><p>Default "tv". String denoting the name of the value-added forecast.</p></dd>


<dt id="arg-scores-name">scores_name<a class="anchor" aria-label="anchor" href="#arg-scores-name"></a></dt>
<dd><p>Default "score_r". String denoting the name of the score residual.</p></dd>


<dt id="arg-cfr-test">cfr_test<a class="anchor" aria-label="anchor" href="#arg-cfr-test"></a></dt>
<dd><p>Default FALSE. Conducts the CFR quasi-experimental test for forecast bias in value-added estimates. Collapses data to school-grade-year-subject
cells with average <code>y</code> and average value-added. Regresses change in <code>y</code> on change in leave-out value-added, using the 2-year leave-outs generated
with the <code>quasi</code> command as in CFR. Regression includes year fixed effects and clusters standard errors by school-cohort. If this is TRUE,
you must specify <code>cfr_school</code>, <code>cfr_grade</code>, and <code>cfr_subject</code> so that the data can be collapsed appropriately. If this is TRUE, the <code>quasi</code>
estimates will automatically be calculated.</p></dd>


<dt id="arg-cfr-school">cfr_school<a class="anchor" aria-label="anchor" href="#arg-cfr-school"></a></dt>
<dd><p>Required if <code>cfr_test</code> is TRUE. Name of the school variable used in the collapse for the <code>cfr_test</code>. Not used in value-added
calculations.</p></dd>


<dt id="arg-cfr-grade">cfr_grade<a class="anchor" aria-label="anchor" href="#arg-cfr-grade"></a></dt>
<dd><p>Required if <code>cfr_test</code> is TRUE. Name of the grade variable used in the collapse for the <code>cfr_test</code>. Not used in value-added
calculations.</p></dd>


<dt id="arg-cfr-subject">cfr_subject<a class="anchor" aria-label="anchor" href="#arg-cfr-subject"></a></dt>
<dd><p>Required if <code>cfr_test</code> is TRUE. Name of the subject variable used in the collapse for the <code>cfr_test</code>. Not used in value-added
calculations.</p></dd>


<dt id="arg-cfr-weight">cfr_weight<a class="anchor" aria-label="anchor" href="#arg-cfr-weight"></a></dt>
<dd><p>Optional if <code>cfr_test</code> is TRUE. Name of the teacher weight variable used in the collapse for <code>cfr_test</code> (typically a
teacher dosage variable greater than 0 and no greater than 1). Not used in the value-added calculations.</p></dd>


<dt id="arg-return-df-only">return_df_only<a class="anchor" aria-label="anchor" href="#arg-return-df-only"></a></dt>
<dd><p>Default FALSE. If TRUE, return only the original dataframe with value-added and residuals appended. If FALSE,
return a list of (a) the original df with value-added and residuals, (b) the variance estimates, (c) the autocovariances by lag, and
(d) a teacher-year-(by) dataset with the value-added estimates. Note that (d) will include teacher estimates for years in which they were
not originally present in the data: this is a difference from the Stata version. To restrict to years in which a teacher was in the data,
use (a) which is the original data with the value-added estimates appended.</p></dd>


<dt id="arg-return-cfr-test-only">return_cfr_test_only<a class="anchor" aria-label="anchor" href="#arg-return-cfr-test-only"></a></dt>
<dd><p>Default FALSE. If TRUE, return only the coefficient and standard error of the <code>cfr_test</code> result. Useful for checking
the bias of many different specifications without having to hold each resulting set of <code>tv</code> estimates in memory.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe or list depending on <code>return_df_only</code> and <code>return_cfr_test_only</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">returned</span> <span class="op">&lt;-</span> <span class="fu">vam</span><span class="op">(</span></span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lvl"</span>, <span class="st">"subject"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_prepped</span>, </span></span>
<span class="r-in"><span>  controls <span class="op">=</span> <span class="va">controls</span>, </span></span>
<span class="r-in"><span>  teacher <span class="op">=</span> <span class="st">"mepid"</span>,</span></span>
<span class="r-in"><span>  class <span class="op">=</span> <span class="st">"section_id"</span>,</span></span>
<span class="r-in"><span>  year <span class="op">=</span> <span class="st">"syear"</span>,</span></span>
<span class="r-in"><span>  tfx_resid <span class="op">=</span> <span class="st">"mepid"</span>, </span></span>
<span class="r-in"><span>  driftlimit <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"test"</span>,</span></span>
<span class="r-in"><span>  return_df_only <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  tv_name <span class="op">=</span> <span class="st">"tv"</span>,</span></span>
<span class="r-in"><span>  scores_name <span class="op">=</span> <span class="st">"score_r"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">VAM estimation</span> ─────────────────────────────────── vamR version 0.0.0.9010 ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Initial function checks.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> Initial function checks. <span style="color: #B2B2B2;">[9ms]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : object 'df_prepped' not found</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Backes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

